{
    "AWSTemplateFormatVersion" : "2010-09-09",

    "Description" : "Patrick EC2 stack for running my services.",

    "Parameters" : {
        "KeyName": {
            "Description": "SSH Keypair to use for the EC2 Instance.",
            "Type": "AWS::EC2::KeyPair::KeyName"
        }
    },
    "Mappings" : {},
    "Conditions" : {},
    "Resources" : {
        "securitygroup" : {
            "Type" : "AWS::EC2::SecurityGroup",
            "Properties" : {
                "GroupDescription" : "Security group for test",
                "SecurityGroupEgress" : [],
                "SecurityGroupIngress" : [
                    {
                       "CidrIp": "0.0.0.0/0",
                       "FromPort" : "443",
                       "IpProtocol" : "tcp",
                       "ToPort" : "443"
                    },
                    {
                       "CidrIp": "0.0.0.0/0",
                       "FromPort" : "22",
                       "IpProtocol" : "tcp",
                       "ToPort" : "22"
                    },
                    {
                       "CidrIp": "0.0.0.0/0",
                       "FromPort" : "80",
                       "IpProtocol" : "tcp",
                       "ToPort" : "80"
                    }
                ],
                "VpcId" : "vpc-860ba5e1"
             }
        },
        "nodemusicec2instance" : {
            "Type" : "AWS::EC2::Instance",
            "Properties" : {
                "SecurityGroupIds" : [ 
                    { 
                        "Fn::GetAtt" : ["securitygroup", "GroupId"]
                    } 
                ],
                "SubnetId" : "subnet-3d184c17",
                "AvailabilityZone" : "us-east-1d",
                "KeyName" : {
                    "Ref" : "KeyName"
                },
                "ImageId" : "ami-fce3c696",
                "InstanceType" : "t2.micro"
            }
        }
    }
}